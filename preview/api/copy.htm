<html>
    <head>
        <title>setCopiedBroad - kdxhub.github.io</title>
        <script>
        function getQueryString(name) {
            let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            let r = window.location.search.substr(1).match(reg);
            if (r != null) {return unescape(r[2]);}
        };
        function copyToClip(content) {
            console.log("欲复制的内容="+content);
            var ele = document.createElement("input"); //创建一个input标签
            ele.setAttribute("value", content); // 设置改input的value值
            document.body.appendChild(ele); // 将input添加到body
            ele.select();  // 获取input的文本内容
            document.execCommand('cut'); // 执行copy指令
            // document.body.removeChild(ele); // 删除input标签
        }
        </script>
    </head>
    <body>
        <script>
            if (getQueryString('encoded') == 1) {
                // 设置剪切板
                copyToClip(decodeURI(decodeURI(getQueryString('str'))));
                var tips = decodeURI(decodeURI(getQueryString('tip')));
                console.log('tip =' + tips)
                // 给提示（tips）
                if (tips != 'non') {
                    console.log('判定结果：tip != non');
                    if (tips == null) {
                        console.log('Use default tip');
                        alert('Copied!')
                    } else {
                        console.log('Use DIY tip')
                        alert(tips)
                    }
                };
                if (getQueryString('nback') != 1) { window.history.back(); alert('执行返回操作')};
            } else {
                // 防止乱码、又要便于调用
                // 当没有encoded标志时，这里直接encode两次URL来规避中文乱码问题
                console.log('First Visviting.  Next URL is ' + encodeURI(encodeURI(window.location)) + '&encoded=1')
                window.location = encodeURI(encodeURI(window.location)) + '&encoded=1';
            }
        </script>
    </body>
</html>